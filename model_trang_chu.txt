<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

// 1. Setting
// Giải thích: Lưu trữ thông tin cấu hình chung của trang chủ như tên website, logo, favicon, thông tin SEO, hotline, địa chỉ, email, slogan, liên kết mạng xã hội, giờ làm việc, link đăng ký Bộ Công Thương, và mô tả footer. Đây là model cốt lõi để hiển thị thông tin cơ bản trên toàn bộ trang chủ.
// Vai trò trong trang chủ: Cung cấp dữ liệu cho header, footer, và các phần thông tin liên hệ, SEO.
class CreateSettingsTable extends Migration
{
    public function up(): void
    {
        Schema::create('settings', function (Blueprint $table) {
            $table->id();
            $table->string('site_name')->nullable();
            $table->string('logo_link')->nullable();
            $table->string('favicon_link')->nullable();
            $table->string('seo_title')->nullable();
            $table->text('seo_description')->nullable();
            $table->string('og_image_link')->nullable();
            $table->string('hotline')->nullable();
            $table->text('address')->nullable();
            $table->string('email')->nullable();
            $table->string('slogan')->nullable();
            $table->string('facebook_link')->nullable();
            $table->string('zalo_link')->nullable();
            $table->string('youtube_link')->nullable();
            $table->string('tiktok_link')->nullable();
            $table->string('working_hours')->nullable();
            $table->string('dmca_link')->nullable();
            $table->text('footer_description')->nullable();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('settings');
    }
}

// 2. WebDesign
// Giải thích: Lưu trữ thông tin giao diện website như ảnh và mô tả của các component giới thiệu (ví dụ: ảnh banner, mô tả công ty), cùng với các số liệu thống kê (số khách hàng, đối tác, sản phẩm, khu vực phân phối).
// Vai trò trong trang chủ: Hiển thị các section giới thiệu công ty, banner, và thống kê ấn tượng.
class CreateWebDesignsTable extends Migration
{
    public function up(): void
    {
        Schema::create('web_designs', function (Blueprint $table) {
            $table->id();
            $table->string('intro_image_1')->nullable();
            $table->string('intro_image_2')->nullable();
            $table->string('intro_image_3')->nullable();
            $table->string('intro_image_4')->nullable();
            $table->text('intro_description_1')->nullable();
            $table->text('intro_description_2')->nullable();
            $table->string('intro_link_1')->nullable();
            $table->string('intro_link_2')->nullable();
            $table->integer('stat_customers')->default(0);
            $table->integer('stat_partners')->default(0);
            $table->integer('stat_products')->default(0);
            $table->integer('stat_regions')->default(0);
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('web_designs');
    }
}

// 3. User
// Giải thích: Quản lý thông tin admin của trang chủ, bao gồm tên, email, mật khẩu, và trạng thái. Quyền hạn (duyệt bài, đăng bài, v.v.) sẽ được quản lý qua package Spatie Laravel Permission.
// Vai trò trong trang chủ: Dùng để quản trị nội dung trang chủ (đăng bài, chỉnh sửa sản phẩm, v.v.) trong Filament.
class CreateUsersTable extends Migration
{
    public function up(): void
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('email')->unique();
            $table->string('password');
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('users');
    }
}

// 4. PostImage
// Giải thích: Lưu trữ các ảnh liên quan đến bài viết của trang chủ, với thông tin như link ảnh, văn bản thay thế, và thứ tự hiển thị.
// Vai trò trong trang chủ: Hiển thị ảnh trong các bài viết tin tức hoặc dịch vụ.
class CreatePostImagesTable extends Migration
{
    public function up(): void
    {
        Schema::create('post_images', function (Blueprint $table) {
            $table->id();
            $table->foreignId('post_id')->nullable()->constrained('posts')->nullOnDelete();
            $table->foreignId('course_post_id')->nullable()->constrained('course_posts')->nullOnDelete();
            $table->string('image_link');
            $table->string('alt_text')->nullable();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('post_images');
    }
}

// 5. MenuItem
// Giải thích: Quản lý menu động, hỗ trợ liên kết đến các trang, danh mục bài viết, bài viết, danh mục sản phẩm, hoặc sản phẩm. Model này hỗ trợ cả trang chủ và khóa học, nhưng trong phạm vi trang chủ, nó sẽ chỉ liên kết đến các nội dung liên quan.
// Vai trò trong trang chủ: Tạo menu điều hướng (header, footer) để dẫn người dùng đến các trang như sản phẩm, tin tức, hoặc liên hệ.
class CreateMenuItemsTable extends Migration
{
    public function up(): void
    {
        Schema::create('menu_items', function (Blueprint $table) {
            $table->id();
            $table->foreignId('parent_id')->nullable()->constrained('menu_items')->nullOnDelete();
            $table->string('label');
            $table->enum('type', ['link', 'cat_post', 'post', 'cat_product', 'product', 'course_cat_post', 'course_post', 'course_cat', 'course'])->default('link');
            $table->string('link')->nullable();
            $table->foreignId('cat_post_id')->nullable()->constrained('cat_posts')->nullOnDelete();
            $table->foreignId('post_id')->nullable()->constrained('posts')->nullOnDelete();
            $table->foreignId('cat_product_id')->nullable()->constrained('cat_products')->nullOnDelete();
            $table->foreignId('product_id')->nullable()->constrained('products')->nullOnDelete();
            $table->foreignId('course_cat_post_id')->nullable()->constrained('course_cat_posts')->nullOnDelete();
            $table->foreignId('course_post_id')->nullable()->constrained('course_posts')->nullOnDelete();
            $table->foreignId('course_cat_id')->nullable()->constrained('course_categories')->nullOnDelete();
            $table->foreignId('course_id')->nullable()->constrained('courses')->nullOnDelete();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('menu_items');
    }
}

// 6. Product
// Giải thích: Lưu trữ thông tin sản phẩm (bánh, nguyên liệu), bao gồm tên, mô tả, giá, giá so sánh, thương hiệu, SKU, tồn kho, đơn vị tính, thông tin SEO, và trạng thái nổi bật.
// Vai trò trong trang chủ: Hiển thị danh sách sản phẩm nổi bật hoặc sản phẩm mới trên trang chủ.
class CreateProductsTable extends Migration
{
    public function up(): void
    {
        Schema::create('products', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->text('description')->nullable();
            $table->string('seo_title')->nullable();
            $table->text('seo_description')->nullable();
            $table->string('og_image_link')->nullable();
            $table->string('slug')->unique();
            $table->decimal('price', 10, 2);
            $table->decimal('compare_price', 10, 2)->nullable();
            $table->string('brand')->nullable();
            $table->string('sku')->unique()->nullable();
            $table->integer('stock')->default(0);
            $table->string('unit')->nullable();
            $table->boolean('is_hot')->default(false);
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->foreignId('category_id')->nullable()->constrained('cat_products')->nullOnDelete();
            $table->timestamps();
        });

        Schema::create('category_product', function (Blueprint $table) {
            $table->id();
            $table->foreignId('category_id')->constrained('cat_products')->cascadeOnDelete();
            $table->foreignId('product_id')->constrained('products')->cascadeOnDelete();
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('category_product');
        Schema::dropIfExists('products');
    }
}

// 7. ProductImage
// Giải thích: Lưu trữ ảnh của sản phẩm, bao gồm ảnh chính, văn bản thay thế, và thứ tự hiển thị.
// Vai trò trong trang chủ: Hiển thị ảnh sản phẩm trong các section sản phẩm hoặc chi tiết sản phẩm.
class CreateProductImagesTable extends Migration
{
    public function up(): void
    {
        Schema::create('product_images', function (Blueprint $table) {
            $table->id();
            $table->foreignId('product_id')->constrained('products')->cascadeOnDelete();
            $table->string('image_link');
            $table->string('alt_text')->nullable();
            $table->boolean('is_main')->default(false);
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('product_images');
    }
}

// 8. CatProduct
// Giải thích: Quản lý danh mục sản phẩm, hỗ trợ cấu trúc cây (danh mục cha-con) và thông tin SEO, mô tả, ảnh đại diện.
// Vai trò trong trang chủ: Hiển thị danh mục sản phẩm trong menu hoặc section sản phẩm.
class CreateCatProductsTable extends Migration
{
    public function up(): void
    {
        Schema::create('cat_products', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('slug')->unique();
            $table->string('seo_title')->nullable();
            $table->text('seo_description')->nullable();
            $table->string('og_image_link')->nullable();
            $table->string('image')->nullable();
            $table->text('description')->nullable();
            $table->foreignId('parent_id')->nullable()->constrained('cat_products')->nullOnDelete();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('cat_products');
    }
}

// 9. Post
// Giải thích: Lưu trữ bài viết cho trang chủ (tin tức, dịch vụ, bài viết thông thường), bao gồm tiêu đề, nội dung, thông tin SEO, ảnh đại diện, và trạng thái nổi bật.
// Vai trò trong trang chủ: Hiển thị tin tức, dịch vụ, hoặc bài viết nổi bật trong section tin tức.
class CreatePostsTable extends Migration
{
    public function up(): void
    {
        Schema::create('posts', function (Blueprint $table) {
            $table->id();
            $table->string('title');
            $table->text('content');
            $table->string('seo_title')->nullable();
            $table->text('seo_description')->nullable();
            $table->string('og_image_link')->nullable();
            $table->string('slug')->unique();
            $table->string('thumbnail')->nullable();
            $table->boolean('is_featured')->default(false);
            $table->enum('type', ['normal', 'news', 'service'])->default('normal');
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->foreignId('category_id')->nullable()->constrained('cat_posts')->nullOnDelete();
            $table->timestamps();
        });

        Schema::create('category_post', function (Blueprint $table) {
            $table->id();
            $table->foreignId('category_id')->constrained('cat_posts')->cascadeOnDelete();
            $table->foreignId('post_id')->constrained('posts')->cascadeOnDelete();
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('category_post');
        Schema::dropIfExists('posts');
    }
}

// 10. CatPost
// Giải thích: Quản lý danh mục bài viết cho trang chủ, hỗ trợ cấu trúc cây và thông tin SEO, mô tả, ảnh đại diện.
// Vai trò trong trang chủ: Hiển thị danh mục bài viết trong menu hoặc section tin tức.
class CreateCatPostsTable extends Migration
{
    public function up(): void
    {
        Schema::create('cat_posts', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('slug')->unique();
            $table->string('seo_title')->nullable();
            $table->text('seo_description')->nullable();
            $table->string('og_image_link')->nullable();
            $table->string('image')->nullable();
            $table->text('description')->nullable();
            $table->foreignId('parent_id')->nullable()->constrained('cat_posts')->nullOnDelete();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('cat_posts');
    }
}

// 11. Cart
// Giải thích: Lưu trữ thông tin giỏ hàng của khách hàng, hỗ trợ cả khách đăng nhập (qua user_id) và khách vãng lai (qua session_id).
// Vai trò trong trang chủ: Cho phép người dùng thêm sản phẩm vào giỏ hàng từ trang chủ.
class CreateCartsTable extends Migration
{
    public function up(): void
    {
        Schema::create('carts', function (Blueprint $table) {
            $table->id();
            $table->foreignId('user_id')->nullable()->constrained('customers')->nullOnDelete();
            $table->string('session_id')->nullable();
            $table->decimal('total', 10, 2)->default(0);
            $table->enum('status', ['active', 'abandoned'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('carts');
    }
}

// 12. CartItem
// Giải thích: Lưu trữ các mặt hàng trong giỏ hàng, bao gồm sản phẩm, số lượng, giá, và tổng phụ.
// Vai trò trong trang chủ: Hiển thị chi tiết các sản phẩm trong giỏ hàng.
class CreateCartItemsTable extends Migration
{
    public function up(): void
    {
        Schema::create('cart_items', function (Blueprint $table) {
            $table->id();
            $table->foreignId('cart_id')->constrained('carts')->cascadeOnDelete();
            $table->foreignId('product_id')->constrained('products')->cascadeOnDelete();
            $table->integer('quantity')->default(1);
            $table->decimal('price', 10, 2);
            $table->decimal('subtotal', 10, 2);
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('cart_items');
    }
}

// 13. Customer
// Giải thích: Lưu trữ thông tin khách hàng mua sản phẩm, bao gồm tên, email, mật khẩu (nếu đăng nhập), số điện thoại, và địa chỉ.
// Vai trò trong trang chủ: Quản lý thông tin khách hàng khi đặt hàng hoặc đăng ký tài khoản.
class CreateCustomersTable extends Migration
{
    public function up(): void
    {
        Schema::create('customers', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('email')->unique()->nullable();
            $table->string('password')->nullable();
            $table->string('phone')->nullable();
            $table->text('address')->nullable();
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('customers');
    }
}

// 14. Order
// Giải thích: Lưu trữ thông tin đơn hàng, bao gồm khách hàng, mã đơn, tổng tiền, trạng thái, phương thức thanh toán, địa chỉ giao hàng, và ghi chú.
// Vai trò trong trang chủ: Quản lý đơn hàng được đặt từ trang chủ.
class CreateOrdersTable extends Migration
{
    public function up(): void
    {
        Schema::create('orders', function (Blueprint $table) {
            $table->id();
            $table->foreignId('customer_id')->nullable()->constrained('customers')->nullOnDelete();
            $table->string('order_number')->unique();
            $table->decimal('total', 10, 2);
            $table->enum('status', ['pending', 'processing', 'completed', 'cancelled'])->default('pending');
            $table->enum('payment_method', ['cod', 'bank_transfer', 'online'])->nullable();
            $table->text('shipping_address')->nullable();
            $table->text('note')->nullable();
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('orders');
    }
}

// 15. OrderItem
// Giải thích: Lưu trữ chi tiết các mặt hàng trong đơn hàng, bao gồm sản phẩm, tên sản phẩm, số lượng, giá, và tổng phụ.
// Vai trò trong trang chủ: Hiển thị chi tiết đơn hàng.
class CreateOrderItemsTable extends Migration
{
    public function up(): void
    {
        Schema::create('order_items', function (Blueprint $table) {
            $table->id();
            $table->foreignId('order_id')->constrained('orders')->cascadeOnDelete();
            $table->foreignId('product_id')->constrained('products')->cascadeOnDelete();
            $table->string('product_name');
            $table->integer('quantity')->default(1);
            $table->decimal('price', 10, 2);
            $table->decimal('subtotal', 10, 2);
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('order_items');
    }
}

// 16. Slider
// Giải thích: Lưu trữ thông tin slider cho trang chủ, bao gồm ảnh, tiêu đề, mô tả, link dẫn đến trang khác, và văn bản thay thế.
// Vai trò trong trang chủ: Hiển thị slider ở đầu trang chủ để giới thiệu công ty hoặc sản phẩm.
class CreateSlidersTable extends Migration
{
    public function up(): void
    {
        Schema::create('sliders', function (Blueprint $table) {
            $table->id();
            $table->string('image_link');
            $table->string('title')->nullable();
            $table->text('description')->nullable();
            $table->string('link')->nullable();
            $table->string('alt_text')->nullable();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('sliders');
    }
}

// 17. Partner
// Giải thích: Lưu trữ thông tin đối tác của trang chủ, bao gồm tên, logo, link website, và mô tả.
// Vai trò trong trang chủ: Hiển thị danh sách đối tác trong section đối tác.
class CreatePartnersTable extends Migration
{
    public function up(): void
    {
        Schema::create('partners', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('logo_link')->nullable();
            $table->string('website_link')->nullable();
            $table->text('description')->nullable();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('partners');
    }
}

// 18. Association
// Giải thích: Lưu trữ thông tin các hiệp hội mà công ty tham gia, bao gồm tên, ảnh, mô tả, và link website.
// Vai trò trong trang chủ: Hiển thị các hiệp hội trong section giới thiệu công ty.
class CreateAssociationsTable extends Migration
{
    public function up(): void
    {
        Schema::create('associations', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('image_link')->nullable();
            $table->text('description')->nullable();
            $table->string('website_link')->nullable();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('associations');
    }
}

// 19. Employee
// Giải thích: Lưu trữ thông tin nhân viên, bao gồm tên, ảnh, chức vụ, số điện thoại, email, và mã QR để quét hiển thị thông tin.
// Vai trò trong trang chủ: Hiển thị thông tin nhân viên khi quét mã QR hoặc trong section đội ngũ.
class CreateEmployeesTable extends Migration
{
    public function up(): void
    {
        Schema::create('employees', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('image_link')->nullable();
            $table->string('position')->nullable();
            $table->string('phone')->nullable();
            $table->string('email')->nullable();
            $table->string('qr_code')->nullable();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('employees');
    }
}

// 20. EmployeeImage
// Giải thích: Lưu trữ ảnh bổ sung của nhân viên, bao gồm link ảnh, văn bản thay thế, và chú thích.
// Vai trò trong trang chủ: Hiển thị các ảnh bổ sung của nhân viên khi xem chi tiết.
class CreateEmployeeImagesTable extends Migration
{
    public function up(): void
    {
        Schema::create('employee_images', function (Blueprint $table) {
            $table->id();
            $table->foreignId('employee_id')->constrained('employees')->cascadeOnDelete();
            $table->string('image_link');
            $table->string('alt_text')->nullable();
            $table->string('caption')->nullable();
            $table->integer('order')->default(0);
            $table->enum('status', ['active', 'inactive'])->default('active');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('employee_images');
    }
}